<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<link href="bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="css/style.css" rel="stylesheet" type="text/css">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Flavien Léger</title>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
	tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] },
	TeX: { equationNumbers: {autoNumber: "AMS"} }
});
</script>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
</head>

<body>
<div class="container">

<ul class="nav nav-tabs">

<li><a href="index.html"><span class="glyphicon glyphicon-home"></span></a></li>

<li class="active"><a href="geometry.html">Research</a></li>

<li><a href="publications.html">Papers</a></li>

<li><a href="slides.html">Slides</a></li>

</ul>




<ul class="nav nav-pills">

<li class="active"><a href="geometry.html">Kim-McCann Geometry</a></li>

<li><a href="optimal-transport.html">Fast OT</a></li>

<li><a href="gradient-flows.html">Wasserstein Gradient Flows</a></li>

<li><a href="monopolist.html">Monopolist</a></li>

<li><a href="sinkhorn.html">Sinkhorn</a></li>

<li><a href="aggregation.html">Aggregation</a></li>

<li><a href="matrixcompletion.html">Matrix Completion</a></li>

</ul>




$$
\newcommand{\R}{\mathbb{R}}
\newcommand{\eps}{\varepsilon}
\newcommand{\ib}{\bar{\imath}}
\newcommand{\jb}{\bar{\jmath}}
\newcommand{\Deltat}{\tilde\Delta}
\newcommand{\Rt}{\tilde R}
\newcommand{\gt}{\tilde g}
\newcommand{\bracket}[1]{\langle #1 \rangle}
\newcommand{\nablat}{\tilde\nabla}
\newcommand{\ot}{\mathrm{OT}}
\newcommand{\abs}[1]{\lvert #1 \rvert}
$$


<h1>Embeddings in the Kim-McCann geometry</h1>



<h2>The Kim-McCann geometry</h2>

<p>Let $X$ and $Y$ be two $d$-dimensional manifolds and $c\colon X\times Y\to\R$ a function called the cost. In the context of optimal transport, Kim and McCann introduced in <a href="#kimmccann">[1]</a> a geometry on $X\times Y$ derived from $c$. The Kim–McCann geometry provides a pseudo-Riemannian metric $\gt$ as well as a parallel endomorphism of $T(X\times Y)$, $K$, called a para-complex structure.
</p>

<p>
Let $U=(\xi,\eta)$ be a vector field over $X\times Y$, then the pseudo-metric takes the form 
$$
  \gt(U,U) = -\nabla^2_{xy}c(x,y)(\xi,\eta),
$$
while the para-complex structure $K$ is simply
\[
  K(U) = (\xi,-\eta).
\]
</p>

<h2>$c$-monotone embeddings</h2>
In addition to X,Y,c let us now consider two potentials $\phi\colon X\to\R$ and $\psi\colon Y\to\R$ and form the quantity 
\[
u(x,y) = c(x,y)-\phi(x)-\psi(y).
\]
Let us suppose that the pair $(\phi,\psi)$ is chosen such that $\phi(x)=\inf_yc(x,y)-\psi(y)$ and $\psi(y)=\inf_xc(x,y)-\phi(x)$. Then $u(x,y)\ge 0$ and the zero set 
\[
\Sigma= \{(x,y)\in X\times Y : u(x,y) = 0\}
\]
is $c$-monotone. Therefore the restriction of $\gt$ to $\Sigma$ is a <b>Riemannian metric</b>, we denote it $g$. 





<h2>A geometric Laplace expansion</h2>

In <a href="#legervialard2022">[2]</a>, we derive the following Laplace formula.


$$
\begin{multline} \label{eq:mainthm}
      \iint_{X\times Y}\frac{e^{-u(x,y)/\eps}}{(2\pi\eps)^{d/2}} \,dr(x,y) = \int_{\Sigma} fdm \,+ \\ \eps\int_\Sigma\Big[- \frac18 \Deltat f +\frac14 \nablat_{\!H} f + f \Big(\frac{3}{32}{\Rt}  - \frac{1}{8}R + \frac{1}{24}\bracket{h,h} -\frac{1}{8}\bracket{H,H} \Big)\Big] \,dm  \\
      + \eps\int_{\partial\Sigma} \frac14 \bracket{\nabla f - K\nabla^N\!f + fKH, \nu}\,d\sigma + O(\eps^2).
    \end{multline}
$$



<h2>Semi-dual functionals</h2>
<p>Let $\mu,\nu$ be two probability measures on $X$ and $Y$ respectively. The optimal transport problem of matching $\mu$ to $\nu$ can be written 
\[
  \ot(\mu,\nu) = \inf \iint_{X\times Y}c(x,y)d\pi(x,y),
\]
where the infimum runs over joint probability measures $\pi$ having first marginal $\mu$ and second marginal $\nu$. As linear program it admits a dual formulation which can be written as 
\[
  \sup_\phi J(\phi),
\]
with 
\[
  J(\phi) = \int_X\phi d\mu + \int_Y\phi^c\,d\nu.
\]
</p>

<p>
The functional $J$ is easily seen to be convex, and therefore when devising an optimization scheme to solve (1) it is important to understand the Hessian of $J$. The Kim–McCann geometry is natural in this context and the Hessian can be written 
\[
  -\delta^2J(\phi)(h,h) = \int_\Sigma \abs{\nabla h}^2\,d\pi_\Sigma.
\]
In the formula above the quantity $\abs{\nabla h}^2$ is the Riemannian metric $g$ on $\Sigma$ inherited from the Kim-McCann metric and $\pi_\Sigma$ is defined as the unique measure on $\Sigma$ having second marginal $\nu$. Note that $\nu$ is the only measure that can play a role in the Hessian of $J$. 
</p>


<h2>References</h2>
<p id="kimmccann">
[1] Kim, Y.-H. and McCann, R. J. (2007). Continuity, curvature, and the general covariance of optimal
  transportation. <em>J. Eur. Math. Soc.</em>, 12.
</p>

<p id="legervialard2022">
[2] Flavien Léger and François-Xavier Vialard. A geometric Laplace expansion. 2022.
</p>





</div><!--container-->
</body>
</html>
